services:
  # Backend API Service
  - type: web
    name: lukens-backend
    env: python
    region: oregon
    plan: starter
    repo: https://github.com/ums-1994/Lukens.git
    branch: cleaned_code_jwt_deployed
    buildCommand: cd backend && pip install -r requirements.txt
    startCommand: cd backend && python migrate_db.py && gunicorn -c gunicorn_conf.py app:app
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: DB_HOST
        fromDatabase:
          name: sowbuilder
          property: host
      - key: DB_PORT
        fromDatabase:
          name: sowbuilder
          property: port
      - key: DB_NAME
        fromDatabase:
          name: sowbuilder
          property: database
      - key: DB_USER
        fromDatabase:
          name: sowbuilder
          property: user
      - key: DB_PASSWORD
        fromDatabase:
          name: sowbuilder
          property: password
      
      # SMTP Configuration
      - key: SMTP_HOST
        value: smtp.gmail.com
      - key: SMTP_PORT
        value: "587"
      - key: SMTP_USER
        value: umsibanda.1994@gmail.com
      - key: SMTP_PASS
        value: aozi xfgg mdcn ylae
      - key: SMTP_FROM_EMAIL
        value: umsibanda.1994@gmail.com
      - key: SMTP_FROM_NAME
        value: Khonology
      
      # Frontend URL
      - key: FRONTEND_URL
        value: https://frontend-sow.onrender.com
      
      # CORS Configuration
      - key: CORS_ORIGIN
        value: https://frontend-sow.onrender.com
      
      # Production URLs
      - key: BACKEND_BASE_URL
        value: https://backend-sow.onrender.com
      
      # Production Settings
      - key: FLASK_DEBUG
        value: "false"
      - key: PORT
        value: "8000"
      
      # Add your other environment variables in Render dashboard
      # OPENROUTER_API_KEY, CLOUDINARY_*, SENDGRID_*, DOCUSIGN_*, FIREBASE_*, etc.
      # FRONTEND_URL=https://sowbuilders.netlify.app (set in Render dashboard)

  # Frontend Static Site
  - type: web
    name: lukens-frontend
    env: static
    region: oregon
    plan: starter
    repo: https://github.com/ums-1994/Lukens.git
    branch: cleaned_code_jwt_deployed
    buildCommand: git clone https://github.com/flutter/flutter.git -b stable /tmp/flutter && export PATH="$PATH:/tmp/flutter/bin" && flutter config --enable-web && cd frontend_flutter && flutter pub get && flutter build web --release --base-href /
    staticPublishPath: frontend_flutter/build/web
    envVars:
      - key: REACT_APP_API_URL
        value: https://backend-sow.onrender.com
        sync: false

databases:
  # PostgreSQL Database
  - name: sowbuilder
    databaseName: sowbuilder
    user: sowbuilder_user
    plan: starter
    region: oregon

